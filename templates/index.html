{% extends "base.html" %} {% block content %}
<div class="flex justify-between items-center mb-6">
  <div class="flex items-center gap-3">
    <h1 class="text-3xl font-bold">shelf</h1>
    <label class="swap swap-rotate">
      <input type="checkbox" id="theme-toggle" onclick="toggleTheme()" />
      <span
        class="swap-on w-6 h-6 bg-current"
        style="
          -webkit-mask: url(/static/icons/sun.svg) center/contain no-repeat;
          mask: url(/static/icons/sun.svg) center/contain no-repeat;
        "
      ></span>
      <span
        class="swap-off w-6 h-6 bg-current"
        style="
          -webkit-mask: url(/static/icons/moon.svg) center/contain no-repeat;
          mask: url(/static/icons/moon.svg) center/contain no-repeat;
        "
      ></span>
    </label>
  </div>

  <div class="join">
    <button
      id="section-media"
      class="btn btn-sm join-item btn-active"
      onclick="switchSection('media')"
    >
      media
    </button>
    <button
      id="section-workouts"
      class="btn btn-sm join-item"
      onclick="switchSection('workouts')"
    >
      workouts
    </button>
  </div>

  <button
    id="add-btn"
    class="btn btn-primary"
    hx-get="/modal/media/new"
    hx-target="#modal-container"
  >
    add media
  </button>
</div>

<div id="main-content">
  <!-- media section -->
  <div id="media-section">
    <div role="tablist" class="tabs tabs-boxed mb-6">
      <a
        role="tab"
        class="tab tab-active"
        hx-get="/media-items?status=queued"
        hx-target="#media-content"
        hx-on::after-request="setActiveTab(this)"
      >
        queued
      </a>
      <a
        role="tab"
        class="tab"
        hx-get="/media-items?status=watching"
        hx-target="#media-content"
        hx-on::after-request="setActiveTab(this)"
      >
        watching
      </a>
      <a
        role="tab"
        class="tab"
        hx-get="/media-items?status=watched"
        hx-target="#media-content"
        hx-on::after-request="setActiveTab(this)"
      >
        watched
      </a>
    </div>

    <div
      id="media-content"
      hx-get="/media-items?status=queued"
      hx-trigger="load"
    >
      <span class="loading loading-spinner loading-lg"></span>
    </div>
  </div>

  <!-- workout section (hidden by default) -->
  <div id="workout-section" class="hidden">
    <div id="workout-content" hx-get="/workout-items" hx-trigger="revealed">
      <span class="loading loading-spinner loading-lg"></span>
    </div>
  </div>
</div>

<script>
  function setActiveTab(clickedTab) {
    document.querySelectorAll('[role="tab"]').forEach((tab) => {
      tab.classList.remove("tab-active");
    });
    clickedTab.classList.add("tab-active");
  }

  function switchSection(section) {
    const mediaSection = document.getElementById("media-section");
    const workoutSection = document.getElementById("workout-section");
    const mediaBtn = document.getElementById("section-media");
    const workoutBtn = document.getElementById("section-workouts");
    const addBtn = document.getElementById("add-btn");

    if (section === "media") {
      mediaSection.classList.remove("hidden");
      workoutSection.classList.add("hidden");
      mediaBtn.classList.add("btn-active");
      workoutBtn.classList.remove("btn-active");
      addBtn.textContent = "add media";
      addBtn.setAttribute("hx-get", "/modal/media/new");
      htmx.process(addBtn);
    } else {
      mediaSection.classList.add("hidden");
      workoutSection.classList.remove("hidden");
      mediaBtn.classList.remove("btn-active");
      workoutBtn.classList.add("btn-active");
      addBtn.textContent = "add workout";
      addBtn.setAttribute("hx-get", "/modal/workout/new");
      htmx.process(addBtn);
    }
  }
</script>
{% endblock %}
