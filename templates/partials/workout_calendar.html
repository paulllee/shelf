<div class="bg-base-200 rounded-lg p-4">
  <div class="flex justify-between items-center mb-4">
    <button
      class="btn btn-ghost btn-sm"
      hx-get="/workout-calendar?year={{ prev_year }}&month={{ prev_month }}"
      hx-target="#workout-calendar"
      hx-swap="outerHTML"
    >
      ←
    </button>
    <span class="font-semibold">{{ month_name }} {{ year }}</span>
    <button
      class="btn btn-ghost btn-sm"
      hx-get="/workout-calendar?year={{ next_year }}&month={{ next_month }}"
      hx-target="#workout-calendar"
      hx-swap="outerHTML"
    >
      →
    </button>
  </div>

  <div class="grid grid-cols-7 gap-1 text-center text-xs mb-2">
    <div class="text-base-content/50">su</div>
    <div class="text-base-content/50">mo</div>
    <div class="text-base-content/50">tu</div>
    <div class="text-base-content/50">we</div>
    <div class="text-base-content/50">th</div>
    <div class="text-base-content/50">fr</div>
    <div class="text-base-content/50">sa</div>
  </div>

  <div class="grid grid-cols-7 gap-1 text-center text-sm">
    {% for _ in range(first_weekday) %}
    <div></div>
    {% endfor %} {% for day in range(1, days_in_month + 1) %} {% set date_str =
    '%04d-%02d-%02d'|format(year, month, day) %} {% set has_workout = date_str
    in workout_dates %} {% set is_today = date_str == today %}
    <div
      class="relative py-1 rounded {% if is_today %}bg-primary/20{% endif %} {% if has_workout %}cursor-pointer hover:bg-base-300{% endif %}"
      {%
      if
      has_workout
      %}onclick="scrollToWorkout('{{ date_str }}')"
      {%
      endif
      %}
    >
      {{ day }} {% if has_workout %}
      <div
        class="absolute bottom-0 left-1/2 -translate-x-1/2 w-1 h-1 rounded-full bg-primary"
      ></div>
      {% endif %}
    </div>
    {% endfor %}
  </div>
</div>

<script>
  function scrollToWorkout(dateStr) {
    const card = document.querySelector(`[data-workout-date="${dateStr}"]`);
    if (card) {
      card.scrollIntoView({ behavior: "smooth", block: "center" });
      card.classList.add("ring-2", "ring-primary");
      setTimeout(() => {
        card.classList.remove("ring-2", "ring-primary");
      }, 2000);
    }
  }
</script>
